for(j in 1:25){
sim_coord_lat[i,j]=(j*latrange)/24 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/24 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults$lat[i*25+j]=sim_coord_lat[i,j]+runif(1,0,latrange/24)
sim_assaults$long[i*25+j]=sim_coord_long[i,j]+runif(1,0,longrange/24)
}
}
}
sim_assaults=data.frame(lat=double(), long=double())
sim_assaults$lat[25]
sim_assaults$lat[25]=75
str(sim_assaults$lat[25])
str(sim_assaults$lat)
str(sim_assaults)
sim_assaults=matrix(data=0, nrow=1000, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=(j*latrange)/24 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/24 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults[i*25+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/24)
sim_assaults[i*25+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/24)
}
}
}
head(sim_assaults)
summary(sim_assaults)
str(sim_assaults)
ggmap::register_google(key = "AIzaSyCslE4ZARIi835Y387tqPAD8Be2RX-unws")
lon=mean(sim_assaults[,2])
lat = mean(sim_assaults[,1])
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 2, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 3, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
#Set your API Key
ggmap::register_google(key = "AIzaSyDYn-fWJiheBslO4pNsiXyOVCOGNSRukbQ")
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = sim_assaults, aes(x=assault$longitude,y=assault$latitude),size = 0.3) +
#  stat_density2d(data=assault, aes(x=assault$longitude, y=assault$latitude), size=0.01, bins=16, geom="polygon") +
scale_fill_gradient(low="yellow",high="red")+
scale_alpha(range = c(0.5,0.9), guide=FALSE)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = sim_assaults, aes(x=sim_assaults[,2],y=sim_assaults[,1]),size = 0.3) +
#  stat_density2d(data=assault, aes(x=assault$longitude, y=assault$latitude), size=0.01, bins=16, geom="polygon") +
scale_fill_gradient(low="yellow",high="red")+
scale_alpha(range = c(0.5,0.9), guide=FALSE)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = sim_assaults, aes(x=sim_assaults[,2],y=sim_assaults[,1]),size = 0.3)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
lat
lon
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
#Set your API Key
ggmap::register_google(key = "AIzaSyB7SOHnpbF2R4vZWdlcaDGf8er1wS0m76Y")
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = sim_assaults, aes(x=sim_assaults[,2],y=sim_assaults[,1]),size = 0.3)
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
library(ggmap)
#Set your API Key
ggmap::register_google(key = "AIzaSyB7SOHnpbF2R4vZWdlcaDGf8er1wS0m76Y")
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
#Set your API Key
ggmap::register_google(key = "AIzaSyB7SOHnpbF2R4vZWdlcaDGf8er1wS0m76Y")
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
#Set your API Key
ggmap::register_google(key = "AIzaSyB7SOHnpbF2R4vZWdlcaDGf8er1wS0m76Y")
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3) +
#  stat_density2d(data=assault, aes(x=assault$longitude, y=assault$latitude), size=0.01, bins=16, geom="polygon") +
scale_fill_gradient(low="yellow",high="red")+
scale_alpha(range = c(0.5,0.9), guide=FALSE)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
assaults_df
sim_assaults=matrix(data=0, nrow=1000, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=(j*latrange)/24 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/24 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/24)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/24)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assault_df$lat)
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)
plot(assaults_df$long, assaults_df$lat)
?pplot.ggplot
?plot
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), max(sim_assaults[,2])), ylim=c(min(sim_assaults[,1]), max(sim_assaults[,1])))
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25, byrow = TRUE)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25, byrow=TRUE)
sim_coord_long=matrix(data=0, nrow=25, ncol=25, byrow=TRUE)
sim_assaults=matrix(data=0, nrow=1000, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=(j*latrange)/24 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/24 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/24)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/24)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
summary(sim_assaults)
sim_assaults
sum(sim_counts)
sum(sim_counts_2D)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/24 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/24 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/24)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/24)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), max(sim_assaults[,2])), ylim=c(min(sim_assaults[,1]), max(sim_assaults[,1])))
summary(assaults_df)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+3), ylim=c(max(sim_assaults[,1])-2, max(sim_assaults[,1])))
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
sim_crimes= sample(1:625,size=1000, prob=freq, replace = TRUE)
summary(sim_crimes)
sim_counts=c(rep(0,625))
for (i in 1:1000){
sim_counts[sim_crimes[i]]=sim_counts[sim_crimes[i]]+1
}
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25, byrow = TRUE)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25, byrow=TRUE)
sim_coord_long=matrix(data=0, nrow=25, ncol=25, byrow=TRUE)
sim_assaults=matrix(data=0, nrow=1000, ncol=2)
sim_counts_2D
sum(sim_counts_2D)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: length(sim_counts_2D[i,j])){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/25)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/25)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: sim_counts_2D[i,j]){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/25)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/25)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: sim_counts_2D[i,j]){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/25)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/25)
}
}
}
sim_crimes= sample(1:625,size=1000, prob=freq, replace = TRUE)
sim_counts=c(rep(0,625))
for (i in 1:1000){
sim_counts[sim_crimes[i]]=sim_counts[sim_crimes[i]]+1
}
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25, byrow = TRUE)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25, byrow=TRUE)
sim_coord_long=matrix(data=0, nrow=25, ncol=25, byrow=TRUE)
sim_assaults=matrix(data=0, nrow=1000, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: sim_counts_2D[i,j]){
sim_assaults[i*24+j, 1]=sim_coord_lat[i,j]+runif(1,0,latrange/25)
sim_assaults[i*24+j, 2]=sim_coord_long[i,j]+runif(1,0,longrange/25)
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
sim_counts_2D[i,j]
sim_counts_2D
assaults_df
length(sim_assaults)
dim(sim_assaults)
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: sim_counts_2D[i,j]){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
dim(sim_assaults)
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
for(k in 1: sim_counts_2D[i,j]-1){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
dim(sim_assaults)
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
if(sim_counts_2D[i,j]!=0){
for(k in 1: sim_counts_2D[i,j]-1){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
}
dim(sim_assaults)
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25)
sim_coord_long=matrix(data=0, nrow=25, ncol=25)
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
if(sim_counts_2D[i,j]!=0){
for(k in 1: sim_counts_2D[i,j]-1){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
}
dim(sim_assaults)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25, byrow = FALSE)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25)
sim_coord_long=matrix(data=0, nrow=25, ncol=25)
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (i in 1:25){
for(j in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
if(sim_counts_2D[i,j]!=0){
for(k in 1: sim_counts_2D[i,j]-1){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
}
dim(sim_assaults)
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
T
sim_counts_2D=matrix(sim_counts, nrow=25, ncol=25, byrow = FALSE)
latrange=maxlat-minlat
longrange=maxlong-minlong
sim_coord_lat=matrix(data=rep(0,625), nrow=25, ncol=25)
sim_coord_long=matrix(data=0, nrow=25, ncol=25)
sim_assaults=matrix(data=0, nrow=0, ncol=2)
for (j in 1:25){
for(i in 1:25){
sim_coord_lat[i,j]=((j-1)*latrange)/25 +minlat
sim_coord_long[i,j]=((i-1)*longrange)/25 +minlong
if(sim_counts_2D[i,j]!=0){
for(k in 1: sim_counts_2D[i,j]-1){
sim_assaults=rbind(sim_assaults,c(sim_coord_lat[i,j]+runif(1,0,latrange/25),sim_coord_long[i,j]+runif(1,0,longrange/25)))
}
}
}
}
dim(sim_assaults)
assaults_df=data.frame(lat=sim_assaults[,1], long=sim_assaults[,2])
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
lon=median(sim_assaults[,2])
lat = median(sim_assaults[,1])
#map<-get_stamenmap(c(left=minlong, bottom=minlat, right=maxlong, top=maxlat), zoom = 5, maptype = "terrain", scale = 2)
map<-get_map(location = c(lon = lon, lat = lat),
zoom = 10, size = c(640, 640), scale = 4, format = "png8", maptype = "roadmap",
color = c("color", "bw"))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
plot(assaults_df$long, assaults_df$lat, xlim=c(min(sim_assaults[,2]), min(sim_assaults[,2])+.5), ylim=c(max(sim_assaults[,1])-.5, max(sim_assaults[,1])))
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
scale_fill_gradient(low="yellow",high="red")
?scale_fill_gradient
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
scale_fill_gradient(low = "#132B43", high = "#56B1F7", guide='colourbar', aesthetics = 'fill')
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
+scale_fill_gradientn(colours = terrain.colors(10))
?scale_fill_gradient
?scale_colour_gradient
?scale_colour_gradientn
?scale_colour_gradient
?scale_colour_gradient2
?scale_fill_gradient
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
+scale_fill_gradient(colours = terrain.colors(10))
?stat_density2d
?stat_density_2d
geom_density2d
?geom_density2d
??geom_density2d
library(ggmap)
?geom_density2d
?stat_density_2d
?stat_density2d
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assault, aes(x=assault$longitude, y=assault$latitude), size=0.01, bins=16, geom="polygon")
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assault_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assault_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assaults_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assaults_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")+
scale_fill_gradient(low = "#132B43", high = "#56B1F7", guide='colourbar', aesthetics = 'fill')
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assaults_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon", fill=stat(level))+
scale_fill_gradient(low = "#132B43", high = "#56B1F7", guide='colourbar', aesthetics = 'fill')
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
stat_density_2d(data=assaults_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")+
scale_colour_gradientn(colours =rainbow_hcl(7))
?scale_fill_gradient
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
#stat_density_2d(data=assaults_df, aes(x=assaults_df$long, y=assaults_df$lat), size=0.01, bins=16, geom="polygon")+
scale_fill_gradient(low = "#132B43", high = "#56B1F7", guide='colourbar', aesthetics = 'fill')
ggmap(map, extent = "panel", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
scale_fill_gradient(colours = terrain.colors(10))
ggmap(map, extent = "normal", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)
ggmap(map, extent = "normal", maprange = FALSE,
legend = "right", padding = 0.02, darken = c(0, "black"))+plot(assaults_df$long, assaults_df$lat)+
geom_density2d(data = assaults_df, aes(x=assaults_df$long,y=assaults_df$lat),size = 0.3)+
scale_fill_gradient(low='blue', high='red')
